<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Lesson Plan - Mekail Hossain</title>
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla&display=swap" rel="stylesheet">
    <style>
        body, html { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; height: 100vh; background: #f1f5f9; }
        .wrapper { display: flex; height: 100vh; }
        .form-side { width: 33%; background: white; padding: 20px; border-right: 2px solid #cbd5e1; overflow-y: auto; }
        .review-side { width: 67%; padding: 30px; background: #475569; overflow-y: auto; display: flex; justify-content: center; }
        .ai-box { background: #eff6ff; padding: 15px; border-radius: 12px; border: 1px solid #3b82f6; margin-bottom: 20px; }
        .btn-ai { background: #1e40af; color: white; border: none; padding: 12px; width: 100%; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-ai:disabled { background: #94a3b8; }
        .paper { background: white; width: 100%; max-width: 800px; padding: 50px; font-family: 'Tiro Bangla', serif; min-height: 1000px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        table, td { border: 1px solid black; padding: 12px; vertical-align: top; }
        input, textarea { width: 100%; padding: 10px; margin-top: 8px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        textarea { height: 100px; }
        #status { font-size: 13px; margin-top: 10px; padding: 10px; border-radius: 5px; display: none; }
        @media print { .form-side, .btn-ai, .ai-box { display: none; } .review-side { width: 100%; background: white; } .paper { box-shadow: none; } }
    </style>
</head>
<body>

<div class="wrapper">
    <aside class="form-side">
        <div class="ai-box">
            <h3 style="margin:0; color:#1e40af;">AI স্মার্ট লেসন প্ল্যানার</h3>
            <p style="font-size:12px; margin-bottom:10px;">টপিক লিখুন (যেমন: 'English Tense')</p>
            <input type="text" id="aiTopic" placeholder="টপিক এখানে লিখুন...">
            <button class="btn-ai" id="genBtn" onclick="generatePlan()">AI দিয়ে তৈরি করুন</button>
            <div id="status"></div>
        </div>

        <h2>প্রাথমিক তথ্য</h2>
        <input type="text" id="inSchool" value="৫১নং গোলখালী সরকারি প্রাথমিক বিদ্যালয়" oninput="sync()">
        <input type="text" id="inName" value="মো: মিকাইল হোসেন" oninput="sync()">
        
        <h2>লেসন কন্টেন্ট</h2>
        <textarea id="inOutcomes" placeholder="Learning Outcomes" oninput="sync()"></textarea>
        <textarea id="inIntro" placeholder="Introduction" oninput="sync()"></textarea>
        <textarea id="inPres" placeholder="Presentation" oninput="sync()"></textarea>
        <textarea id="inPrac" placeholder="Practice" oninput="sync()"></textarea>
        <textarea id="inAss" placeholder="Assessment" oninput="sync()"></textarea>
    </aside>

    <main class="review-side">
        <div class="paper">
            <div style="text-align:center;">
                <h1 id="viewSchool" style="margin:0;">বিদ্যালয়ের নাম</h1>
                <p>কয়রা, খুলনা</p>
                <h3 style="border: 2px solid black; display: inline-block; padding: 5px 20px; margin-top:10px;">Daily Lesson Plan</h3>
            </div>
            <p style="margin-top:20px;"><strong>শিক্ষক:</strong> <span id="viewName"></span></p>
            <table>
                <tr><td width="30%" style="font-weight:bold; background:#f9f9f9;">Outcomes</td><td id="viewOutcomes"></td></tr>
                <tr><td style="font-weight:bold; background:#f9f9f9;">Introduction</td><td id="viewIntro"></td></tr>
                <tr><td style="font-weight:bold; background:#f9f9f9;">Presentation</td><td id="viewPres"></td></tr>
                <tr><td style="font-weight:bold; background:#f9f9f9;">Practice</td><td id="viewPrac"></td></tr>
                <tr><td style="font-weight:bold; background:#f9f9f9;">Assessment</td><td id="viewAss"></td></tr>
            </table>
            <p style="text-align:center; font-size:12px; margin-top:50px; font-family: sans-serif;">Generated by Mekail Hossain &copy; 2026</p>
        </div>
    </main>
</div>

<script>
    // আপনার এপিআই কি সরাসরি এখানে দেওয়া হলো
    const API_KEY = "AIzaSyAjpj1DD5p1BXjYENF94Kg3Bz6S24dty-Q";

    function sync() {
        const ids = ['School', 'Name', 'Outcomes', 'Intro', 'Pres', 'Prac', 'Ass'];
        ids.forEach(id => {
            const val = document.getElementById('in' + id).value;
            const view = document.getElementById('view' + id);
            if(view) view.innerHTML = val.replace(/\n/g, '<br>');
        });
    }

    async function generatePlan() {
        const topic = document.getElementById('aiTopic').value;
        const status = document.getElementById('status');
        const btn = document.getElementById('genBtn');

        if(!topic) { alert("দয়া করে একটি টপিক লিখুন!"); return; }

        btn.disabled = true;
        status.style.display = "block";
        status.style.background = "#dbeafe";
        status.style.color = "#1e40af";
        status.innerText = "এআই আপনার জন্য প্ল্যানটি লিখছে... দয়া করে ১০-২০ সেকেন্ড অপেক্ষা করুন।";

        // এআই প্রম্পট
        const prompt = `Act as an expert primary teacher. Write a short English lesson plan for topic: "${topic}". 
        Response format must be exactly like this:
        OUTCOMES: [text]
        INTRODUCTION: [text]
        PRESENTATION: [text]
        PRACTICE: [text]
        ASSESSMENT: [text]`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });

            if (!response.ok) {
                const errorInfo = await response.json();
                throw new Error(errorInfo.error.message || "Unknown API Error");
            }

            const data = await response.json();
            const fullText = data.candidates[0].content.parts[0].text;

            // ডেটা আলাদা করার লজিক
            function parse(tag) {
                const regex = new RegExp(`${tag}:?\\s*([\\s\\S]*?)(?=INTRODUCTION|PRESENTATION|PRACTICE|ASSESSMENT|$)`, 'i');
                const match = fullText.match(regex);
                return

